"use strict";function $http(t){function n(t,n,s){var i,c=new XMLHttpRequest;if(t===e.GET)n=function(t,n){if(!n)return t;var e=t+"?",o=0;for(var r in n)n.hasOwnProperty(r)&&(o++&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(n[r]));return e}(n,s),i=null;else{if(!s)return;i=new FormData,Object.keys(s).forEach(function(t){i.append(t,s[t])})}if(t===e.GET){var a=iqwerty.http.Cache().getCache(n);if(null!=a)return"function"==typeof r.onLoad?r.onLoad(a):Promise.resolve(a)}return"function"==typeof r.onLoadStart&&(c.onloadstart=function(){r.onLoadStart(this.readyState)}),"function"==typeof r.onProgress&&(c.upload.onprogress=function(t){r.onProgress(t)}),new Promise(function(s,a){"function"==typeof r.onError&&(c.onerror=function(){r.onError(this.status),a(this.status)}),c.onload=function(){u.cache&&t===e.GET&&iqwerty.http.Cache().setCache(n,this.response),"function"==typeof r.onLoad&&(this.status===o.OK?r.onLoad(this.response):"function"==typeof r.onError&&r.onError(this.status)),this.status===o.OK?s(this.response):a(this.status)},c.open(t,n,!0),c.send(i)})}var e={GET:"get",POST:"post",PUT:"put",DELETE:"delete"},o={OK:200},r={},u={};return{cache:function(){return u.cache=!0,this},begin:function(t){return r.onLoadStart=t,this},progress:function(t){return r.onProgress=t,this},success:function(t){return r.onLoad=t,this},error:function(t){return r.onError=t,this},get:function(o){return n(e.GET,t,o)},post:function(o){return n(e.POST,t,o)},put:function(o){return n(e.PUT,t,o)},delete:function(o){return n(e.DELETE,t,o)}}}var iqwerty=iqwerty||{};iqwerty.http=function(){function t(){var n={},e=t.prototype.cached;return n.getCache=function(t){return e[t]},n.setCache=function(t,o){null==n.getCache(t)&&(e[t]=o)},n}return t.prototype.cached={},{Request:$http,Cache:t}}(),"undefined"!=typeof module&&(module.exports=iqwerty.http);